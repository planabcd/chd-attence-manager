<body>
<div class="easyui-panel" data-option="fit:true" title="学生信息管理" style="padding:10px" >
    <table>
        <tr>
            <td>专业</td><td><input type="text" id="major"></td>
        </tr>
        <tr>
            <td>开始</td><td><input type="text" id="starttime"></td>
        </tr>
        <tr>
            <td>结束</td><td><input type="text" id="endtime"></td>
        </tr>
    </table>
    <table id="dg"></table>
</div>
<script type="text/javascript">

    $(function(){
        $( "#starttime" ).datepicker({
            changeMonth: true,
            changeYear: true,
            dateFormat:"yy-mm-dd"
        });
    })
    var toolbar = [
        {
            text: '查询',
            iconCls: 'icon-add',
            handler: function () {
                $('#dg').datagrid({
                    queryParams: {
                        major: $("#major").val(),
                        strattime: $("#starttime").val(),
                        endtime: $("#starttime").val()
                    },
                    url:"${request.contextPath}/rest/student",
                    pageNum:1
                });
            }
        },
        {
            text: '新增',
            iconCls: 'icon-add',
            handler: function () {
                window.location.href="${request.contextPath}/rest/student/0"
            }
        }, {
            text: '修改',
            iconCls: 'icon-edit',
            handler: function () {
                var row = $("#dg").datagrid('getSelections');
                if(row.length==1){
                    var id=row[0].id;
                    window.location.href="${request.contextPath}/rest/student/"+id;
                }else{
                    alert("请选择一行");
                }
            }

        },{text: '删除',
            iconCls: 'icon-cut',
            handler: function () {
                var row = $("#dg").datagrid('getSelections');
                if(row.length==1){
                    var msg = "您真的确定要删除吗?";
                    if (confirm(msg)!=true){
                        return;
                    }
                    var id=row[0].id;
                    var deleteUrl = "${pageContext.request.contextPath}/appversion/delete/"+id;
                    $.ajax({
                        url:deleteUrl,
                        dataType:"json",
                        type:"post",
                        success:function(data){
                            alert(data.msg);
                            if(data.isSuccess == true){
                                //重新加载数据
                                window.location.href="<%=request.getContextPath()%>/appversion/list";
                            }
                        },
                        error:function(data){
                            alert("删除失败");
                        }
                    });
                }else{
                    alert("请选择一行");
                }
            }}
    ];
    $('#dg').datagrid({
        url:"${request.contextPath}/rest/student",
        method:"GET",
        columns:[[
            {field:'id',title:'编号',checkbox:true},
            {field:'stuId',title:'学号'},
            {field:'name',title:'姓名'},
            {field:'academy',title:'学院'},
            {field:'major',title:'专业'},
            {field:'classId',title:'班级'},
            {field:'grade',title:'年级'},
            {field:'created',title:'创建时间',formatter:formatDatebox},
            {field:'updated',title:'修改时间',formatter:formatDatebox}
        ]] ,
        toolbar: toolbar,
        pagination:true,
        pageSize: 10,
        pageList: [10,25,50]
    });
</script>
</body>
